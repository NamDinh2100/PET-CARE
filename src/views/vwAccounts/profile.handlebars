{{#section 'css'}}
<style>
    /* Ẩn sidebar trên trang profile */
    #sidebarMenu {
        display: none !important;
    }

    /* Main content chiếm toàn bộ chiều rộng */
    main.col-md-10.col-lg-10 {
        width: 100% !important;
        max-width: 100% !important;
        flex: 0 0 100% !important;
        margin-left: 0 !important;
    }

    .profile-header-section {
    background: white;
    border-radius: 25px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    padding: 40px 40px 25px; /* tăng padding-top */
    margin-top: 20px;
    border: 2px solid #e9ecef;
}

    .username-section {
        display: flex;
        justify-content: space-between;
        align-items: center;
        /* Không cần padding 0 40px vì đã có ở header-section */
    }

    .user-info-wrapper {
        display: flex;
        align-items: center;
        gap: 20px;
        /* Khoảng cách giữa avatar và chữ */
    }

    .username-title {
        font-family: 'Abhaya Libre', serif;
        font-size: 1.5rem;
        font-weight: 700;
        text-transform: uppercase;
        color: #212529;
    }

    .username-subtitle {
        color: #6c757d;
        font-size: 0.95rem;
        margin-top: 2px;
    }

    .nav-section {
        border-top: 2px solid #b52323;
        /* Làm nhạt đường kẻ cho thanh thoát */
        margin-top: 15px;
        padding-top: 10px;
    }

    .nav-section .nav-link {
        font-weight: 600;
        text-transform: uppercase;
        font-size: 0.9rem;
        color: #495057;
        border: none;
        padding-bottom: 10px;
        transition: all 0.3s;
    }

    .nav-section .nav-link:hover,
    .nav-section .nav-link.active {
        color: #0d6efd;
        border-bottom: 4px solid #0d6efd;
    }

    .content-section {
        background: white;
        border-radius: 20px;
        border: 2px solid #e9ecef;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        margin-top: 30px;
        margin-bottom: 40px;
        overflow: hidden;
    }

    .content-header {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        padding: 20px 30px;
        border-bottom: 2px solid #dee2e6;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .content-title {
        font-family: 'Abhaya Libre', serif;
        font-size: 1.25rem;
        font-weight: 700;
        text-transform: uppercase;
        color: #212529;
    }

    .content-body {
        padding: 30px 40px;
    }

    .form-label-page {
        font-weight: 600;
        font-size: 0.8rem;
        text-transform: uppercase;
        margin-bottom: 10px;
        color: #495057;
        display: block;
        letter-spacing: 0.5px;
    }

    .custom-input-page {
        border: 2px solid #dee2e6;
        border-radius: 20px;
        padding: 12px 20px;
        font-weight: 500;
        background-color: #f8f9fa;
        transition: all 0.3s;
    }

    .custom-input-page:focus {
        border-color: #0d6efd;
        background-color: white;
        box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.15);
    }

    .custom-input-page:disabled {
        background-color: #e9ecef;
        cursor: not-allowed;
        color: #6c757d;
    }
</style>
{{/section}}

<div class="container-fluid my-4">
    <a href="javascript:history.back()" class="text-dark text-decoration-none"><i class="bi bi-arrow-left fs-4"></i></a>
    {{!-- Success/Error Messages --}}
    {{#if success}}
    <div class="alert alert-success alert-dismissible fade show rounded-3" role="alert">
        {{#if (eq success 'updated')}}
        <i class="bi bi-check-circle me-2"></i> Profile updated successfully!
        {{/if}}
        {{#if (eq success 'password_changed')}}
        <i class="bi bi-check-circle me-2"></i> Password changed successfully!
        {{/if}}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    {{/if}}

    {{#if error}}
    <div class="alert alert-danger alert-dismissible fade show rounded-3" role="alert">
        {{#if (eq error 'wrong_password')}}
        <i class="bi bi-exclamation-circle me-2"></i> Current password is incorrect!
        {{/if}}
        {{#if (eq error 'password_mismatch')}}
        <i class="bi bi-exclamation-circle me-2"></i> New passwords do not match!
        {{/if}}
        {{#if (eq error 'password_short')}}
        <i class="bi bi-exclamation-circle me-2"></i> Password must be at least 6 characters!
        {{/if}}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    {{/if}}

    {{!-- Profile Form --}}
    <div class="content-section">
        <div class="content-header">
            <h5 class="content-title mb-0">Personal Information</h5>
            <button type="button" class="btn btn-outline-danger btn-sm fw-bold" data-bs-toggle="modal"
                data-bs-target="#changePasswordModal">
                <i class="bi bi-key me-1"></i> Change Password
            </button>
        </div>
        <div class="content-body">
            <form id="profileForm" method="POST" action="/profile/update">
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <label class="form-label-page">Full Name</label>
                        <input type="text" name="full_name" class="form-control custom-input-page"
                            value="{{authUser.full_name}}" required>
                    </div>
                    <div class="col-md-6 mb-4">
                        <label class="form-label-page">Email</label>
                        <input type="email" class="form-control custom-input-page" value="{{authUser.email}}" disabled>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <label class="form-label-page">Phone</label>
                        <input type="tel" name="phone" class="form-control custom-input-page" value="{{authUser.phone}}"
                            placeholder="Enter phone number">
                    </div>
                    <div class="col-md-6 mb-4">
                        <label class="form-label-page">Address</label>
                        <input type="text" name="address" class="form-control custom-input-page text-uppercase" value="{{authUser.address}}">
                    </div>
                </div>

                <div class="text-end mt-4 pt-3 border-top">
                    <button type="submit" class="btn btn-outline-success fw-bold px-5">
                        <i class="bi bi-check-circle me-1"></i> SAVE CHANGES
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>