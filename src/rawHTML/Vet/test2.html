<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PetCareUS - Bảng Điều Khiển</title>
    <!-- Tải Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Cấu hình Tailwind cho màu sắc và font chữ tùy chỉnh
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'pc-blue': '#3B82F6', // Màu xanh dương chính
                        'pc-dark-blue': '#2563EB', // Màu xanh đậm hơn
                        'pc-gray': '#E5E7EB', // Màu nền xám nhạt
                        'pc-bg-card': '#F9F9F9', // Màu nền xám nhẹ cho thẻ lịch
                        'pc-red': '#EF4444', // Màu đỏ cho ngày cuối tuần
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        /* Đảm bảo font Inter được tải */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');

        /* Custom style cho layout */
        .sidebar {
            width: 250px;
            flex-shrink: 0; /* Ngăn sidebar bị co lại */
        }

        /* Ẩn tiêu đề label trên desktop */
        @media (min-width: 768px) {
            .grid > div[data-label]:before {
                content: none;
            }
        }

        /* Responsive cho thiết bị di động (hiện label) */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                border-bottom: 1px solid #ccc;
            }
            /* Hiện thị label cho di động */
            .grid > div[data-label]:before {
                content: attr(data-label);
                font-weight: 600;
                color: #4B5563; /* gray-700 */
                margin-right: 0.5rem;
            }
            /* Đảm bảo bảng hiển thị theo chiều dọc */
            .grid {
                display: flex;
                flex-direction: column;
            }
            .grid-cols-5 {
                grid-template-columns: 1fr;
            }
        }
    </style>
    <!-- Tải AlpineJS để quản lý trạng thái currentView dễ dàng -->
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
</head>
<body class="bg-gray-50 min-h-screen font-sans" x-data="{ currentView: 'appointment' }">

    <!-- Thanh header -->
    <header class="flex justify-between items-center p-4 md:px-8 bg-white border-b border-gray-200 shadow-sm">
        <!-- Logo -->
        <div class="flex items-center space-x-1">
            <svg class="w-8 h-8 text-pc-blue" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10m0 0h16m-4 0v-4m4 4H8m-4 0H2m12 0H8m4 4v-4m0 0v-4m0 4h4m-4 0h-4"></path></svg>
            <span class="text-xl font-bold text-gray-800">PetCare<span class="text-pc-blue">US</span></span>
        </div>
        
        <!-- Thông tin người dùng -->
        <div class="flex items-center space-x-4">
            <div class="hidden md:block text-right text-sm leading-tight">
                <p class="font-medium text-red-600">VETERINARIAN</p>
                <p class="text-xs text-gray-500">@vet_name</p>
            </div>
            <!-- Icon Profile -->
            <button class="flex items-center justify-center w-10 h-10 bg-gray-200 text-gray-600 rounded-full hover:bg-gray-300 transition duration-150" aria-label="Tài khoản người dùng">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"></path></svg>
            </button>
            <!-- Dropdown Arrow -->
            <button class="hidden md:block text-gray-600 hover:text-gray-800 transition duration-150" aria-label="Mở menu">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
            </button>
        </div>
    </header>

    <!-- Nội dung chính: Sidebar và Khu vực Cuộc hẹn/Lịch trình -->
    <div class="flex flex-col md:flex-row min-h-[calc(100vh-65px)]">
        
        <!-- Sidebar (Menu bên trái) -->
        <nav class="sidebar bg-white border-r border-gray-200 p-4 md:p-6 shadow-md md:shadow-none">
            <ul class="flex md:block space-x-4 md:space-x-0 md:space-y-2 overflow-x-auto pb-2">
                <!-- Nút LỊCH TRÌNH -->
                <li>
                    <button id="schedule-btn" class="w-full flex items-center p-3 font-medium text-sm md:text-base rounded-lg transition duration-150" 
                            :class="currentView === 'schedule' ? 'text-white bg-pc-blue hover:bg-pc-dark-blue' : 'text-gray-600 hover:bg-pc-gray'" 
                            onclick="handleNavigation('schedule')">
                        <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2m-9 0V3h4v2m-4 0v2h4V5m-4 0H5a2 2 0 00-2 2v10a2 2 0 002 2h14a2 2 0 002-2V7a2 2 0 00-2-2h-2m-6 0V3h4v2m-4 0v2h4V5"></path></svg>
                        LỊCH TRÌNH
                    </button>
                </li>
                <!-- Nút CUỘC HẸN -->
                <li>
                    <button id="appointment-btn" class="w-full flex items-center p-3 font-medium text-sm md:text-base rounded-lg transition duration-150"
                            :class="currentView === 'appointment' ? 'text-white bg-pc-blue hover:bg-pc-dark-blue' : 'text-gray-600 hover:bg-pc-gray'" 
                            onclick="handleNavigation('appointment')">
                        <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-4 4h.01M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                        CUỘC HẸN
                    </button>
                </li>
            </ul>
        </nav>

        <!-- Khu vực nội dung chính -->
        <main class="flex-1 p-4 md:p-8 main-content-area">

            <!-- ============================================== -->
            <!-- Chế độ xem DANH SÁCH CUỘC HẸN (APPOINTMENT VIEW) -->
            <!-- ============================================== -->
            <div id="appointment-view" :class="{'block': currentView === 'appointment', 'hidden': currentView !== 'appointment'}">
                
                <!-- Thanh tìm kiếm -->
                <div class="flex justify-end mb-6">
                    <div class="relative w-full max-w-md">
                        <input type="text" id="search-input-appointment" placeholder="TÌM KIẾM..." 
                            class="w-full px-4 py-2 pr-10 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-pc-blue transition duration-150"
                            onkeydown="if(event.key === 'Enter') handleSearch('appointment')">
                        <button class="absolute right-0 top-0 mt-2.5 mr-3 text-gray-500 hover:text-pc-dark-blue" onclick="handleSearch('appointment')" aria-label="Tìm kiếm">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                        </button>
                    </div>
                </div>

                <!-- Bảng Cuộc Hẹn -->
                <div class="bg-white rounded-xl shadow-lg overflow-hidden border border-gray-300">
                    
                    <!-- Header Bảng -->
                    <div class="bg-gray-200 border-b border-gray-300 p-4">
                        <h2 class="text-lg md:text-xl font-semibold text-gray-700 uppercase tracking-wider">DANH SÁCH CUỘC HẸN</h2>
                    </div>

                    <!-- Tiêu đề cột (Chỉ hiển thị trên Desktop) -->
                    <div class="grid grid-cols-5 text-center font-bold text-gray-600 border-b border-gray-300 bg-gray-100/50 hidden md:grid">
                        <div class="p-3 text-left pl-6">ID User</div>
                        <div class="p-3">Dịch vụ</div>
                        <div class="p-3">Ngày & Giờ</div>
                        <div class="p-3">Trạng thái</div>
                        <div class="p-3">Hành động</div>
                    </div>

                    <!-- Danh sách dữ liệu -->
                    <div id="appointment-list-data">
                        <!-- Mẫu hàng dữ liệu 1: Đang chờ -->
                        <div class="grid grid-cols-1 md:grid-cols-5 gap-y-2 md:gap-y-0 p-4 border-b border-gray-200 hover:bg-gray-50 transition duration-100">
                            <div class="text-left md:pl-6 font-medium text-gray-900" data-label="ID User:">#U12345</div>
                            <div class="text-left md:text-center text-gray-700" data-label="Dịch vụ:">Kiểm tra sức khỏe</div>
                            <div class="text-left md:text-center text-gray-700" data-label="Ngày & Giờ:">05/11/2025 - 10:00</div>
                            <div class="text-left md:text-center">
                                <span id="status-1" class="inline-block px-3 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">Đang chờ</span>
                            </div>
                            <div class="text-left md:text-center">
                                <button class="action-btn px-3 py-1 bg-pc-blue text-white text-sm rounded-lg hover:bg-pc-dark-blue transition duration-150 shadow-md" data-id="1" onclick="handleAction('1', 'confirm')">
                                    Xác nhận
                                </button>
                            </div>
                        </div>
                        <!-- Mẫu hàng dữ liệu 2: Đã xác nhận -->
                        <div class="grid grid-cols-1 md:grid-cols-5 gap-y-2 md:gap-y-0 p-4 border-b border-gray-200 hover:bg-gray-50 transition duration-100">
                            <div class="text-left md:pl-6 font-medium text-gray-900" data-label="ID User:">#U12346</div>
                            <div class="text-left md:text-center text-gray-700" data-label="Dịch vụ:">Tiêm phòng</div>
                            <div class="text-left md:text-center text-gray-700" data-label="Ngày & Giờ:">05/11/2025 - 11:30</div>
                            <div class="text-left md:text-center">
                                <span id="status-2" class="inline-block px-3 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">Đã xác nhận</span>
                            </div>
                            <div class="text-left md:text-center">
                                <button class="action-btn px-3 py-1 bg-gray-500 text-white text-sm rounded-lg hover:bg-gray-600 transition duration-150 shadow-md" data-id="2" onclick="handleAction('2', 'complete')">
                                    Hoàn tất
                                </button>
                            </div>
                        </div>
                         <!-- Mẫu hàng dữ liệu 3: Đã hoàn tất -->
                        <div class="grid grid-cols-1 md:grid-cols-5 gap-y-2 md:gap-y-0 p-4 border-b border-gray-200 hover:bg-gray-50 transition duration-100">
                            <div class="text-left md:pl-6 font-medium text-gray-900" data-label="ID User:">#U12347</div>
                            <div class="text-left md:text-center text-gray-700" data-label="Dịch vụ:">Phẫu thuật khẩn cấp</div>
                            <div class="text-left md:text-center text-gray-700" data-label="Ngày & Giờ:">04/11/2025 - 09:00</div>
                            <div class="text-left md:text-center">
                                <span id="status-3" class="inline-block px-3 py-1 text-xs font-semibold rounded-full bg-gray-200 text-gray-600">Đã hoàn tất</span>
                            </div>
                            <div class="text-left md:text-center text-sm text-gray-500">
                                Đã xử lý
                            </div>
                        </div>
                    </div>

                    <!-- Thanh Phân trang -->
                    <div class="bg-gray-100 p-3 md:p-4 flex justify-end items-center space-x-2 border-t border-gray-300">
                        <button class="pagination-btn flex items-center p-2 text-gray-500 rounded-lg hover:bg-gray-200 transition duration-150" onclick="changePage(-1)" aria-label="Trang trước">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                        </button>
                        <!-- Nút trang (Được cập nhật bởi JS) -->
                        <div id="pagination-numbers" class="flex space-x-1">
                            <!-- JS sẽ render các nút trang tại đây -->
                        </div>
                        <button class="pagination-btn flex items-center p-2 text-gray-500 rounded-lg hover:bg-gray-200 transition duration-150" onclick="changePage(-2)" aria-label="Trang sau">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                        </button>
                    </div>

                </div>
            </div>


            <!-- ==================================== -->
            <!-- Chế độ xem LỊCH TRÌNH (SCHEDULE VIEW) -->
            <!-- ==================================== -->
            <div id="schedule-view" :class="{'block': currentView === 'schedule', 'hidden': currentView !== 'schedule'}">
                
                <!-- Card Lịch -->
                <div class="bg-white rounded-xl shadow-lg overflow-hidden border border-gray-300">
                    
                    <!-- Header Lịch -->
                    <div class="flex flex-col sm:flex-row justify-between items-center bg-gray-200 border-b border-gray-300 p-4 space-y-2 sm:space-y-0">
                        <h2 class="text-lg md:text-xl font-semibold text-gray-700 uppercase tracking-wider">LỊCH TRÌNH</h2>
                        <div class="flex items-center space-x-4">
                            <span id="current-month-year" class="text-xl font-medium text-gray-800">Tháng Mười Một - 2025</span>
                            <button class="px-3 py-1 bg-pc-blue text-white text-sm font-semibold rounded-lg hover:bg-pc-dark-blue transition duration-150 shadow-md flex items-center" onclick="handleEditSchedule()">
                                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-7-3L21 3m-3 3l-6 6"></path></svg>
                                Chỉnh sửa
                            </button>
                        </div>
                    </div>

                    <!-- Tiêu đề ngày trong tuần -->
                    <div class="grid grid-cols-7 text-center font-bold text-gray-700 bg-gray-100 border-b border-gray-300">
                        <div class="p-3">Th 2</div>
                        <div class="p-3">Th 3</div>
                        <div class="p-3">Th 4</div>
                        <div class="p-3">Th 5</div>
                        <div class="p-3">Th 6</div>
                        <div class="p-3 text-pc-red">Th 7</div>
                        <div class="p-3 text-pc-red">CN</div>
                    </div>

                    <!-- Lưới Lịch (35 ô) -->
                    <div id="calendar-grid" class="grid grid-cols-7 gap-px border-t border-gray-200 bg-gray-200 p-px">
                        <!-- JS sẽ render nội dung lịch tại đây -->
                        <template x-for="i in 35">
                            <div :class="{'h-24 p-2 transition duration-150 cursor-pointer': true, 
                                          'bg-pc-bg-card text-gray-400': i < 4 || i > 33, /* Ngày ngoài tháng */
                                          'bg-white text-gray-800 hover:border-pc-blue border border-transparent': i >= 4 && i <= 33, /* Ngày trong tháng */
                                          'bg-pc-blue/10': i === 7 /* Ngày 5/11 có hẹn (giả lập) */
                                        }" 
                                 @click="showDayDetails(i)">
                                <div class="font-bold text-sm" :class="{'text-pc-red': i === 7 || i === 8 || i === 14 || i === 15 || i === 21 || i === 22 || i === 28 || i === 29 || i === 35}">
                                    <span x-text="i < 4 ? i + 27 : (i > 33 ? i - 33 : i - 3)"></span>
                                </div>
                                <div x-show="i === 7" class="text-xs text-blue-600 font-medium mt-1">2 Hẹn</div>
                                <div x-show="i === 8" class="text-xs text-gray-500 mt-1">Nghỉ</div>
                            </div>
                        </template>
                    </div>

                    <!-- Thanh điều hướng Lịch -->
                    <div class="bg-gray-100 p-4 flex justify-between items-center border-t border-gray-300">
                        <button class="flex items-center p-2 text-gray-600 rounded-lg hover:bg-gray-200 transition duration-150 font-medium" onclick="changeMonth(-1)">
                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                            Trước
                        </button>
                        <button class="flex items-center p-2 text-gray-600 rounded-lg hover:bg-gray-200 transition duration-150 font-medium" onclick="changeMonth(1)">
                            Sau
                            <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                        </button>
                    </div>

                </div>
            </div>

        </main>

    </div>

    <!-- Modal tùy chỉnh thay cho alert/confirm -->
    <div id="app-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-6 shadow-2xl max-w-sm w-full transform transition-all duration-300 scale-95" id="modal-content">
            <h3 class="text-xl font-bold mb-4 text-gray-800" id="modal-title">Thông báo</h3>
            <p class="text-gray-600 mb-6" id="modal-body">Nội dung thông báo...</p>
            <div class="flex justify-end space-x-3">
                <button class="px-4 py-2 bg-gray-200 text-gray-700 font-medium rounded-lg hover:bg-gray-300 transition duration-150" onclick="hideModal()">Đóng</button>
            </div>
        </div>
    </div>

    <script>
        // Khai báo biến trạng thái trang hiện tại (danh sách cuộc hẹn)
        let currentPage = 1;
        const totalPages = 5; // Giả lập tổng số trang

        // Khai báo biến trạng thái lịch trình
        let currentMonth = 10; // 0=Tháng 1, 10=Tháng 11
        let currentYear = 2025;
        const monthNames = ["Tháng Một", "Tháng Hai", "Tháng Ba", "Tháng Tư", "Tháng Năm", "Tháng Sáu", 
                            "Tháng Bảy", "Tháng Tám", "Tháng Chín", "Tháng Mười", "Tháng Mười Một", "Tháng Mười Hai"];
        
        // --- Chức năng Modal tùy chỉnh ---
        function showModal(title, body, type = 'info') {
            const modal = document.getElementById('app-modal');
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-body').textContent = body;
            
            // Cập nhật kiểu modal (nếu cần, ví dụ: màu tiêu đề)
            const titleElement = document.getElementById('modal-title');
            titleElement.classList.remove('text-pc-blue', 'text-pc-red', 'text-yellow-600');
            if (type === 'success') {
                titleElement.classList.add('text-pc-blue');
            } else if (type === 'error') {
                titleElement.classList.add('text-pc-red');
            }

            modal.classList.remove('hidden');
            modal.classList.add('flex');
            // Thêm hiệu ứng animation
            setTimeout(() => {
                document.getElementById('modal-content').classList.remove('scale-95');
                document.getElementById('modal-content').classList.add('scale-100');
            }, 50);
        }

        function hideModal() {
            const modal = document.getElementById('app-modal');
            document.getElementById('modal-content').classList.remove('scale-100');
            document.getElementById('modal-content').classList.add('scale-95');
            setTimeout(() => {
                modal.classList.remove('flex');
                modal.classList.add('hidden');
            }, 300);
        }

        // --- Chức năng chuyển View (Sidebar) ---
        function handleNavigation(viewName) {
            // Cập nhật biến currentView, AlpineJS sẽ tự động cập nhật hiển thị
            document.querySelector('body').__x.$data.currentView = viewName;
            
            if (viewName === 'appointment') {
                // Đảm bảo nút phân trang được render lại khi quay lại
                renderPagination();
            }
            
            showToast(`Đã chuyển sang ${viewName === 'schedule' ? 'Lịch trình' : 'Danh sách cuộc hẹn'}.`);
        }
        
        // --- Chức năng tìm kiếm ---
        function handleSearch(view) {
            const inputId = view === 'appointment' ? 'search-input-appointment' : 'search-input-schedule';
            const query = document.getElementById(inputId)?.value || 'Trống';
            
            showToast(`Đang tìm kiếm trong ${view === 'appointment' ? 'Cuộc hẹn' : 'Lịch trình'} với từ khóa: "${query}"`);
            // Thêm logic lọc dữ liệu thực tế tại đây
        }

        // --- Chức năng Hành động Cuộc hẹn ---
        function handleAction(id, action) {
            const statusElement = document.getElementById(`status-${id}`);
            let message = '';
            let actionBtn = document.querySelector(`.action-btn[data-id="${id}"]`);

            if (!statusElement) return;

            // Xóa tất cả các class màu trạng thái cũ
            statusElement.classList.remove('bg-yellow-100', 'text-yellow-800', 'bg-green-100', 'text-green-800', 'bg-gray-200', 'text-gray-600');
            
            if (action === 'confirm') {
                // Cập nhật trạng thái và màu sắc
                statusElement.textContent = 'Đã xác nhận';
                statusElement.classList.add('bg-green-100', 'text-green-800');
                
                // Thay đổi nút hành động
                if (actionBtn) {
                    actionBtn.textContent = 'Hoàn tất';
                    actionBtn.setAttribute('onclick', `handleAction('${id}', 'complete')`);
                    actionBtn.classList.remove('bg-pc-blue', 'hover:bg-pc-dark-blue');
                    actionBtn.classList.add('bg-gray-500', 'hover:bg-gray-600');
                }
                
                message = `Đã xác nhận cuộc hẹn #${id}.`;
            } else if (action === 'complete') {
                // Cập nhật trạng thái và màu sắc
                statusElement.textContent = 'Đã hoàn tất';
                statusElement.classList.add('bg-gray-200', 'text-gray-600');
                
                // Xóa nút hành động và thay bằng text
                if (actionBtn) {
                    const parentDiv = actionBtn.parentElement;
                    actionBtn.remove();
                    
                    const completedText = document.createElement('div');
                    completedText.className = 'text-sm text-gray-500';
                    completedText.textContent = 'Đã xử lý';
                    parentDiv.appendChild(completedText);
                }
                
                message = `Đã hoàn tất cuộc hẹn #${id}.`;
            }

            showToast(message, 'success');
        }

        // --- Chức năng Phân trang (Appointment View) ---

        // Hàm render các nút số trang
        function renderPagination() {
            const paginationContainer = document.getElementById('pagination-numbers');
            if (!paginationContainer) return;
            paginationContainer.innerHTML = '';

            for (let i = 1; i <= totalPages; i++) {
                const btn = document.createElement('button');
                btn.className = 'pagination-btn w-8 h-8 flex items-center justify-center rounded-md transition duration-150';
                btn.setAttribute('data-page', i);
                btn.setAttribute('onclick', `changePage(${i})`);
                btn.textContent = i;
                
                if (i === currentPage) {
                    btn.classList.add('font-bold', 'text-white', 'bg-gray-800', 'shadow');
                    btn.classList.remove('font-medium', 'text-gray-700', 'hover:bg-gray-300');
                } else {
                    btn.classList.add('font-medium', 'text-gray-700', 'hover:bg-gray-300');
                    btn.classList.remove('font-bold', 'text-white', 'bg-gray-800', 'shadow');
                }
                paginationContainer.appendChild(btn);
            }
        }

        // Hàm chuyển trang
        function changePage(pageOrDirection) {
            let nextPage = currentPage;

            if (pageOrDirection === -1) { // Nút Trước
                nextPage = Math.max(1, currentPage - 1);
            } else if (pageOrDirection === -2) { // Nút Sau 
                nextPage = Math.min(totalPages, currentPage + 1);
            } else { // Nhấp vào số trang cụ thể
                nextPage = pageOrDirection;
            }

            if (nextPage === currentPage) return;

            currentPage = nextPage;
            renderPagination(); // Cập nhật trạng thái active
            
            showToast(`Đang tải dữ liệu Trang ${currentPage}...`);
            // Thêm logic tải dữ liệu trang mới (AJAX/Fetch) tại đây
        }

        // --- Logic cho Lịch trình (Schedule View) ---
        function updateCalendarHeader() {
            const header = document.getElementById('current-month-year');
            if (header) {
                header.textContent = `${monthNames[currentMonth]} - ${currentYear}`;
            }
        }

        function changeMonth(direction) {
            currentMonth += direction;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            } else if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            updateCalendarHeader();
            showToast(`Đã chuyển sang ${monthNames[currentMonth]} ${currentYear}.`);
            // Trong ứng dụng thực tế: render lại các ngày trong lịch tại đây
        }

        function handleEditSchedule() {
            showModal("Chỉnh sửa Lịch trình", "Chức năng này sẽ mở giao diện cho phép Bác sĩ thiết lập giờ làm việc và nghỉ phép.", 'info');
        }

        function showDayDetails(dayIndex) {
            // Giả định ngày 5/11 là ngày có hẹn, tương ứng với index 7 trong Alpine loop (4 ngày đầu + 3 ngày sau)
            const dayOfMonth = (dayIndex < 4 ? dayIndex + 27 : (dayIndex > 33 ? dayIndex - 33 : dayIndex - 3));
            let message = `Xem chi tiết lịch hẹn ngày ${dayOfMonth}/${currentMonth + 1}/${currentYear}.`;
            if (dayIndex === 7) {
                 message += " Ngày này có 2 cuộc hẹn đã được xác nhận.";
            } else if (dayIndex === 8) {
                 message += " Ngày này là Chủ nhật, đã đặt trạng thái Nghỉ.";
            }
            showModal(`Chi tiết Ngày ${dayOfMonth}/${currentMonth + 1}`, message, 'info');
        }


        // --- Hàm tạo Toast/Message Box ---
        function showToast(message, type = 'info') {
            const toastId = 'app-toast';
            let toast = document.getElementById(toastId);

            if (!toast) {
                toast = document.createElement('div');
                toast.id = toastId;
                toast.className = 'fixed bottom-5 right-5 z-50 p-3 text-white rounded-lg shadow-xl transition-opacity duration-300 opacity-0';
                document.body.appendChild(toast);
            }

            // Cập nhật màu nền dựa trên loại thông báo
            toast.classList.remove('bg-gray-800', 'bg-pc-blue', 'bg-pc-red', 'bg-yellow-600');
            if (type === 'success') {
                toast.classList.add('bg-pc-blue');
            } else if (type === 'error') {
                toast.classList.add('bg-pc-red');
            } else {
                 // Mặc định cho info
                toast.classList.add('bg-gray-800');
            }

            // Cập nhật nội dung và hiển thị
            toast.textContent = message;
            toast.classList.remove('opacity-0');
            toast.classList.add('opacity-90');

            // Tự động ẩn sau 3 giây
            setTimeout(() => {
                toast.classList.remove('opacity-90');
                toast.classList.add('opacity-0');
            }, 3000);
        }

        // Khởi tạo trạng thái ban đầu khi tải trang
        window.onload = function() {
            // Khởi tạo phân trang và calendar header
            renderPagination(); 
            updateCalendarHeader();
            console.log('Bảng Điều khiển đã tải xong.');
        };
    </script>

</body>
</html>